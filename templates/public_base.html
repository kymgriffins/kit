<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Budget Ndio Story - Financial Empowerment Platform{% endblock %}</title>
    <meta name="description" content="Budget Ndio Story - Your journey to financial freedom. Access financial education, budgeting tools, and community support.">
    <meta name="keywords" content="budget, finance, money management, financial education, Kenya, Africa">
    <meta name="author" content="Budget Ndio Story">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Budget Ndio Story - Financial Empowerment Platform">
    <meta property="og:description" content="Your journey to financial freedom starts here. Access budgeting tools, financial education, and community support.">
    <meta property="og:image" content="/static/images/og-image.jpg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="{{ request.build_absolute_uri|default:'https://budgetndiostory.org' }}">
    
    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://cdn.tailwindcss.com">
    
    <!-- Fonts - NeueMontreal -->
    <style>
        @font-face {
            font-family: 'NeueMontreal';
            src: url('NeueMontreal.woff') format('woff');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['NeueMontreal', 'Inter', 'sans-serif'],
                        body: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            DEFAULT: '#0066CC',
                            light: '#1a75ff',
                            dark: '#004c99',
                            50: '#e6f0ff',
                            100: '#cce0ff',
                        },
                        accent: {
                            blue: '#0066CC',
                            white: '#ffffff',
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-in': 'slideIn 0.3s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideIn: {
                            '0%': { transform: 'translateX(-100%)' },
                            '100%': { transform: 'translateX(0)' },
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        /* CSS Variables for Theme - Black/White/Blue */
        :root {
            --primary-color: #0066CC;
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --bg-tertiary: #171717;
            --bg-dark: #000000;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-tertiary: #666666;
            --text-inverse: #000000;
            --border-color: #262626;
            --border-light: #171717;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.3);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.3), 0 2px 4px -2px rgb(0 0 0 / 0.3);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3), 0 4px 6px -4px rgb(0 0 0 / 0.3);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.4), 0 8px 10px -6px rgb(0 0 0 / 0.4);
            --glass-bg: rgba(0, 0, 0, 0.8);
            --glass-border: rgba(255, 255, 255, 0.1);
            --card-bg: #0a0a0a;
            --nav-bg: rgba(0, 0, 0, 0.95);
        }

        /* Dark Mode Variables */
        [data-theme="dark"] {
            --primary-color: #2dd4bf;
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --bg-dark: #020617;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-tertiary: #94a3b8;
            --text-inverse: #0f172a;
            --border-color: #334155;
            --border-light: #1e293b;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.3);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.3), 0 2px 4px -2px rgb(0 0 0 / 0.3);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3), 0 4px 6px -4px rgb(0 0 0 / 0.3);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.4), 0 8px 10px -6px rgb(0 0 0 / 0.4);
            --glass-bg: rgba(15, 23, 42, 0.9);
            --glass-border: rgba(255, 255, 255, 0.1);
            --card-bg: #1e293b;
            --nav-bg: rgba(15, 23, 42, 0.95);
        }

        /* Base Styles with Theme Variables */
        * {
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.15s ease;
        }

        body {
            font-family: 'NeueMontreal', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Theme Transition */
        body * {
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.2s ease, box-shadow 0.3s ease;
        }

        /* Custom Scrollbar - Theme Aware */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--text-tertiary);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }

        /* Focus Visible for Accessibility */
        *:focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        /* Primary Color Text */
        .text-primary-color {
            color: var(--primary-color);
        }

        /* Primary Color Background */
        .bg-primary-color {
            background-color: var(--primary-color);
        }

        /* Primary Color Border */
        .border-primary-color {
            border-color: var(--primary-color);
        }

        /* Gradient Text - solid blue */
        .gradient-text {
            color: #0066CC;
        }

        /* Theme-aware Card */
        .card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }

        /* Theme-aware Glass Effect - solid black */
        .glass {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Navigation Styles */
        .nav-link {
            position: relative;
            color: var(--text-secondary);
            transition: color 0.2s ease;
        }
        
        .nav-link:hover {
            color: var(--text-primary);
        }
        
        .nav-link.active {
            color: var(--primary-color);
        }

        /* Button Styles */
        .btn-primary {
            background: var(--primary-color);
            color: white;
            padding: 0.625rem 1.5rem;
            border-radius: 9999px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 102, 204, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            padding: 0.625rem 1.5rem;
            border-radius: 9999px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            border-color: #0066CC;
            color: #0066CC;
        }

        /* Input Styles */
        .form-input {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
            width: 100%;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #0066CC;
            box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
        }
        
        .form-input::placeholder {
            color: var(--text-tertiary);
        }

        /* Section Backgrounds */
        .section-light {
            background-color: var(--bg-secondary);
        }

        .section-dark {
            background-color: var(--bg-dark);
        }

        /* Print Styles */
        @media print {
            .no-print { display: none !important; }
            .theme-toggle { display: none !important; }
        }

        /* Animation Classes */
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Stagger Animation Delays */
        .stagger-1 { animation-delay: 0.1s; }
        .stagger-2 { animation-delay: 0.2s; }
        .stagger-3 { animation-delay: 0.3s; }
        .stagger-4 { animation-delay: 0.4s; }
    </style>
    
    {% block extra_css %}{% endblock %}
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Budget Ndio Story",
        "url": "https://budgetndiostory.org",
        "logo": "https://budgetndiostory.org/static/images/logo.png",
        "description": "Financial empowerment platform for budgeting and money management",
        "sameAs": [
            "https://facebook.com/budgetndiostory",
            "https://twitter.com/budgetndiostory",
            "https://instagram.com/budgetndiostory"
        ]
    }
    </script>
</head>
<body class="min-h-screen">
    
    <!-- Skip to Main Content for Accessibility -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:fixed focus:top-4 focus:left-4 bg-blue-600 text-white px-4 py-2 rounded-lg z-50 font-medium">
        Skip to main content
    </a>

    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 nav glass" style="background-color: var(--nav-bg);">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <a href="/" class="flex items-center space-x-2 group">
                    <div class="w-10 h-10 rounded-xl bg-blue-600 flex items-center justify-center">
                        <span class="text-white font-bold text-lg">B</span>
                    </div>
                    <span class="font-bold text-xl" style="color: var(--text-primary);">Budget Ndio Story</span>
                </a>
                
                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center space-x-6">
                    <a href="/videos/" class="nav-link font-medium {% if request.path == '/videos/' %}active{% endif %}">Videos</a>
                    <a href="/blog/" class="nav-link font-medium {% if '/blog' in request.path %}active{% endif %}">Blog</a>
                    <a href="/about/" class="nav-link font-medium {% if request.path == '/about/' %}active{% endif %}">About</a>
                    <a href="/contact/" class="nav-link font-medium {% if request.path == '/contact/' %}active{% endif %}">Contact</a>
                    <a href="/donate/" class="btn-primary">Donate</a>
                    
                    <!-- Theme Toggle Button -->
                    <button id="theme-toggle" class="theme-toggle p-2 rounded-lg transition-all hover:bg-gray-100 dark:hover:bg-gray-800" aria-label="Toggle theme" title="Toggle theme">
                        <!-- Sun Icon (shown in dark mode) -->
                        <svg id="theme-icon-sun" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                        <!-- Moon Icon (shown in light mode) -->
                        <svg id="theme-icon-moon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                        </svg>
                    </button>
                </div>
                
                <!-- Mobile Menu Button -->
                <div class="flex items-center space-x-2 md:hidden">
                    <!-- Mobile Theme Toggle -->
                    <button id="mobile-theme-toggle" class="theme-toggle p-2 rounded-lg transition-all" aria-label="Toggle theme">
                        <svg id="mobile-theme-icon-sun" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                        <svg id="mobile-theme-icon-moon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                        </svg>
                    </button>
                    <button id="mobile-menu-btn" class="p-2 rounded-lg transition-colors" style="color: var(--text-primary);" aria-label="Toggle menu">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden border-t" style="border-color: var(--border-color);">
            <div class="px-4 py-4 space-y-3">
                <a href="/videos/" class="block nav-link font-medium py-2" style="color: var(--text-primary);">Videos</a>
                <a href="/blog/" class="block nav-link font-medium py-2" style="color: var(--text-primary);">Blog</a>
                <a href="/about/" class="block nav-link font-medium py-2" style="color: var(--text-primary);">About</a>
                <a href="/contact/" class="block nav-link font-medium py-2" style="color: var(--text-primary);">Contact</a>
                <a href="/donate/" class="block btn-primary text-center mt-4">Donate</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="main-content" class="pt-16">
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="border-t" style="background-color: var(--bg-secondary); border-color: var(--border-color);">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <!-- Brand -->
                <div class="col-span-1 md:col-span-2">
                    <a href="/" class="flex items-center space-x-2 mb-4">
                        <div class="w-10 h-10 rounded-xl bg-blue-600 flex items-center justify-center">
                            <span class="text-white font-bold text-lg">B</span>
                        </div>
                        <span class="font-bold text-xl" style="color: var(--text-primary);">Budget Ndio Story</span>
                    </a>
                    <p class="mb-4" style="color: var(--text-secondary);">
                        Empowering citizens to understand and engage with Kenya's national and county budgets. Your journey to financial freedom starts here.
                    </p>
                    <div class="flex space-x-4">
                        <a href="#" class="p-2 rounded-lg transition-colors hover:bg-primary-100 dark:hover:bg-gray-800" aria-label="Twitter">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg>
                        </a>
                        <a href="#" class="p-2 rounded-lg transition-colors hover:bg-primary-100 dark:hover:bg-gray-800" aria-label="Facebook">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
                        </a>
                        <a href="#" class="p-2 rounded-lg transition-colors hover:bg-primary-100 dark:hover:bg-gray-800" aria-label="YouTube">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M23.498 6.186a3.016 3.016 0 00-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 00.502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 002.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 002.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>
                        </a>
                        <a href="#" class="p-2 rounded-lg transition-colors hover:bg-primary-100 dark:hover:bg-gray-800" aria-label="Instagram">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.067.06 1.407.06 4.123v.08c0 2.643-.012 2.987-.06 4.043-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.067.048-1.407.06-4.123.06h-.08c-2.643 0-2.987-.012-4.043-.06-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.047-1.024-.06-1.379-.06-3.808v-.63c0-2.43.013-2.784.06-3.808.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 015.468 2.53c.636-.247 1.363-.416 2.427-.465C8.901 2.013 9.256 2 11.685 2h.63zm-.081 1.802h-.468c-2.456 0-2.784.011-3.807.058-.975.045-1.504.207-1.857.344-.467.182-.8.398-1.15.748-.35.35-.566.683-.748 1.15-.137.353-.3.882-.344 1.857-.047 1.023-.058 1.351-.058 3.807v.468c0 2.456.011 2.784.058 3.807.045.975.207 1.504.344 1.857.182.466.399.8.748 1.15.35.35.683.566 1.15.748.353.137.882.3 1.857.344 1.054.048 1.37.058 4.041.058h.08c2.597 0 2.917-.01 3.96-.058.976-.045 1.505-.207 1.858-.344.466-.182.8-.398 1.15-.748.35-.35.566-.683.748-1.15.137-.353.3-.882.344-1.857.048-1.055.058-1.37.058-4.041v-.08c0-2.597-.01-2.917-.058-3.96-.045-.976-.207-1.505-.344-1.858a3.097 3.097 0 00-.748-1.15 3.098 3.098 0 00-1.15-.748c-.353-.137-.882-.3-1.857-.344-1.023-.047-1.351-.058-3.807-.058zM12 6.865a5.135 5.135 0 110 10.27 5.135 5.135 0 010-10.27zm0 1.802a3.333 3.333 0 100 6.666 3.333 3.333 0 000-6.666zm5.338-3.205a1.2 1.2 0 110 2.4 1.2 1.2 0 010-2.4z"/></svg>
                        </a>
                    </div>
                </div>
                
                <!-- Quick Links -->
                <div>
                    <h4 class="font-semibold mb-4" style="color: var(--text-primary);">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="/videos/" class="nav-link" style="color: var(--text-secondary);">Videos</a></li>
                        <li><a href="/blog/" class="nav-link" style="color: var(--text-secondary);">Blog</a></li>
                        <li><a href="/about/" class="nav-link" style="color: var(--text-secondary);">About Us</a></li>
                        <li><a href="/contact/" class="nav-link" style="color: var(--text-secondary);">Contact</a></li>
                        <li><a href="/newsletter/" class="nav-link" style="color: var(--text-secondary);">Newsletter</a></li>
                    </ul>
                </div>
                
                <!-- Resources -->
                <div>
                    <h4 class="font-semibold mb-4" style="color: var(--text-primary);">Resources</h4>
                    <ul class="space-y-2">
                        <li><a href="/donate/" class="nav-link" style="color: var(--text-secondary);">Donate</a></li>
                        <li><a href="#" class="nav-link" style="color: var(--text-secondary);">Privacy Policy</a></li>
                        <li><a href="#" class="nav-link" style="color: var(--text-secondary);">Terms of Service</a></li>
                        <li><a href="/api/docs/" class="nav-link" style="color: var(--text-secondary);">API Documentation</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t mt-8 pt-8 text-center" style="border-color: var(--border-color);">
                <p style="color: var(--text-tertiary);">
                    &copy; {% now "Y" %} Budget Ndio Story. All rights reserved.
                </p>
            </div>
        </div>
    </footer>

    <!-- Theme Toggle JavaScript -->
    <script>
        // Theme configuration
        const THEME_KEY = 'bns-theme-preference';
        
        // Get the current theme from localStorage or system preference
        function getThemePreference() {
            const stored = localStorage.getItem(THEME_KEY);
            if (stored) {
                return stored;
            }
            // Default to light mode
            return 'light';
        }
        
        // Apply theme to the document
        function applyTheme(theme) {
            const html = document.documentElement;
            html.setAttribute('data-theme', theme);
            localStorage.setItem(THEME_KEY, theme);
            
            // Update icons
            const sunIcons = document.querySelectorAll('#theme-icon-sun, #mobile-theme-icon-sun');
            const moonIcons = document.querySelectorAll('#theme-icon-moon, #mobile-theme-icon-moon');
            
            if (theme === 'dark') {
                sunIcons.forEach(icon => icon.classList.remove('hidden'));
                moonIcons.forEach(icon => icon.classList.add('hidden'));
            } else {
                sunIcons.forEach(icon => icon.classList.add('hidden'));
                moonIcons.forEach(icon => icon.classList.remove('hidden'));
            }
        }
        
        // Toggle theme
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            applyTheme(newTheme);
        }
        
        // Initialize theme on page load
        function initTheme() {
            const theme = getThemePreference();
            applyTheme(theme);
            
            // Add event listeners to all theme toggle buttons
            const desktopToggle = document.getElementById('theme-toggle');
            const mobileToggle = document.getElementById('mobile-theme-toggle');
            
            if (desktopToggle) {
                desktopToggle.addEventListener('click', toggleTheme);
            }
            if (mobileToggle) {
                mobileToggle.addEventListener('click', toggleTheme);
            }
        }
        
        // Run on DOM ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initTheme);
        } else {
            initTheme();
        }
        
        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        
        if (mobileMenuBtn && mobileMenu) {
            mobileMenuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
        }
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>
